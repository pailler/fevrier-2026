<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Cache Bypass - IA Home</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #f0f9ff;
        }
        .test-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #3b82f6;
        }
        .btn {
            background: #3b82f6;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s;
        }
        .btn:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }
        .success { background: #10b981; }
        .warning { background: #f59e0b; }
        .danger { background: #ef4444; }
        .result {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status.success { background: #d1fae5; color: #065f46; }
        .status.error { background: #fee2e2; color: #991b1b; }
        .status.warning { background: #fef3c7; color: #92400e; }
    </style>
</head>
<body>
    <div class="test-card">
        <h1>üîÑ Test Cache Bypass - IA Home</h1>
        <p><strong>Timestamp:</strong> <span id="timestamp"></span></p>
        <p><strong>Objectif:</strong> Forcer le rechargement de l'application et contourner le cache Cloudflare</p>
    </div>

    <div class="test-card">
        <h2>üß™ Tests de Cache</h2>
        <button onclick="testDirectAccess()" class="btn">1. Test Acc√®s Direct</button>
        <button onclick="testCacheBusting()" class="btn success">2. Test Cache Busting</button>
        <button onclick="testForceRefresh()" class="btn warning">3. Test Force Refresh</button>
        <button onclick="testIncognito()" class="btn danger">4. Test Navigation Priv√©e</button>
        
        <div id="results" class="result" style="display: none;"></div>
    </div>

    <div class="test-card">
        <h2>üìã Modifications Attendues</h2>
        <ul>
            <li>‚úÖ <strong>Banni√®re rouge</strong> : "VERSION MISE √Ä JOUR" en haut de page</li>
            <li>‚úÖ <strong>Modules essentiels</strong> : "Module essentiel ‚úÖ"</li>
            <li>‚úÖ <strong>Modules IA</strong> : "Module IA ü§ñ"</li>
            <li>‚úÖ <strong>Plus de "premium"</strong> : Toutes les r√©f√©rences supprim√©es</li>
        </ul>
    </div>

    <div class="test-card">
        <h2>üîß Solutions de Contournement</h2>
        <button onclick="purgeCloudflareCache()" class="btn danger">üóëÔ∏è Purger Cache Cloudflare</button>
        <button onclick="clearBrowserCache()" class="btn warning">üßπ Vider Cache Navigateur</button>
        <button onclick="hardReload()" class="btn success">‚ö° Rechargement Forc√©</button>
    </div>

    <div class="test-card">
        <h2>üìä Status de l'Application</h2>
        <div id="app-status" class="status warning">V√©rification en cours...</div>
        <button onclick="checkAppStatus()" class="btn">üîÑ V√©rifier Status</button>
    </div>

    <script>
        // Afficher le timestamp
        document.getElementById('timestamp').textContent = new Date().toLocaleString();

        function log(message) {
            const results = document.getElementById('results');
            results.style.display = 'block';
            results.textContent += new Date().toLocaleTimeString() + ': ' + message + '\n';
        }

        function updateStatus(message, type) {
            const status = document.getElementById('app-status');
            status.textContent = message;
            status.className = `status ${type}`;
        }

        async function testDirectAccess() {
            log('üß™ Test acc√®s direct...');
            try {
                const response = await fetch('https://iahome.fr/encours');
                if (response.ok) {
                    const text = await response.text();
                    if (text.includes('VERSION MISE √Ä JOUR')) {
                        log('‚úÖ SUCC√àS: Modifications visibles!');
                        updateStatus('‚úÖ Modifications d√©tect√©es!', 'success');
                    } else {
                        log('‚ùå √âCHEC: Modifications non visibles');
                        updateStatus('‚ùå Modifications non visibles', 'error');
                    }
                } else {
                    log('‚ùå ERREUR: ' + response.status);
                    updateStatus('‚ùå Erreur ' + response.status, 'error');
                }
            } catch (error) {
                log('‚ùå ERREUR: ' + error.message);
                updateStatus('‚ùå Erreur de connexion', 'error');
            }
        }

        async function testCacheBusting() {
            log('üß™ Test cache busting...');
            const timestamp = Date.now();
            try {
                const response = await fetch(`https://iahome.fr/encours?v=${timestamp}&cb=${Math.random()}`);
                if (response.ok) {
                    const text = await response.text();
                    if (text.includes('VERSION MISE √Ä JOUR')) {
                        log('‚úÖ SUCC√àS: Cache busting fonctionne!');
                        updateStatus('‚úÖ Cache busting r√©ussi!', 'success');
                    } else {
                        log('‚ùå √âCHEC: Cache busting √©chou√©');
                        updateStatus('‚ùå Cache busting √©chou√©', 'error');
                    }
                } else {
                    log('‚ùå ERREUR: ' + response.status);
                }
            } catch (error) {
                log('‚ùå ERREUR: ' + error.message);
            }
        }

        function testForceRefresh() {
            log('üß™ Test force refresh...');
            const timestamp = Date.now();
            window.location.href = `https://iahome.fr/encours?v=${timestamp}&force=1&cb=${Math.random()}`;
        }

        function testIncognito() {
            log('üß™ Ouverture navigation priv√©e...');
            window.open('https://iahome.fr/encours', '_blank');
        }

        function purgeCloudflareCache() {
            log('üóëÔ∏è Redirection vers dashboard Cloudflare...');
            window.open('https://dash.cloudflare.com', '_blank');
        }

        function clearBrowserCache() {
            log('üßπ Instructions pour vider le cache:');
            log('Chrome/Edge: Ctrl + Shift + Delete ‚Üí Tout effacer');
            log('Firefox: Ctrl + Shift + Delete ‚Üí Tout effacer');
            log('Safari: Cmd + Option + E');
        }

        function hardReload() {
            log('‚ö° Rechargement forc√©...');
            window.location.reload(true);
        }

        async function checkAppStatus() {
            log('üîÑ V√©rification du status de l\'application...');
            try {
                const response = await fetch('https://iahome.fr');
                if (response.ok) {
                    log('‚úÖ Application accessible');
                    updateStatus('‚úÖ Application accessible', 'success');
                } else {
                    log('‚ùå Application non accessible: ' + response.status);
                    updateStatus('‚ùå Application non accessible', 'error');
                }
            } catch (error) {
                log('‚ùå Erreur de connexion: ' + error.message);
                updateStatus('‚ùå Erreur de connexion', 'error');
            }
        }

        // V√©rification automatique au chargement
        window.onload = function() {
            checkAppStatus();
            setTimeout(testDirectAccess, 2000);
        };
    </script>
</body>
</html>
