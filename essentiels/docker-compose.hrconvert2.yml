version: '3.7'
services:
  hrconvert2:
    image: dwaaan/hrconvert2-docker:latest
    container_name: hrconvert2
    restart: unless-stopped
    ports:
      - "9082:80"
    volumes:
      - ./hrconvert2/config.php:/var/www/html/HRProprietary/HRConvert2/config.php
      - ./hrconvert2_data:/home/converter:rw
      - ./hrconvert2_logs:/var/www/html/HRProprietary/HRConvert2/Logs:rw
      - ./hrconvert2_uploads:/var/www/html/HRProprietary/HRConvert2/uploads:rw
    environment:
      - TZ=Europe/Paris
      - PHP_MEMORY_LIMIT=512M
      - UPLOAD_MAX_FILESIZE=100M
      - POST_MAX_SIZE=100M
    networks:
      - iahome-network

  # Service LibreOffice pour conversion de documents
  libreoffice:
    image: lscr.io/linuxserver/libreoffice:latest
    container_name: hrconvert2-libreoffice
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Paris
    volumes:
      - ./libreoffice_data:/config
      - ./hrconvert2_data:/converter:rw
    networks:
      - iahome-network

  # Service ImageMagick pour conversion d'images
  imagemagick:
    image: imagemagick/imagemagick:latest
    container_name: hrconvert2-imagemagick
    restart: unless-stopped
    volumes:
      - ./hrconvert2_data:/data:rw
    networks:
      - iahome-network

  # Service FFmpeg pour conversion vid√©o/audio
  ffmpeg:
    image: jrottenberg/ffmpeg:latest
    container_name: hrconvert2-ffmpeg
    restart: unless-stopped
    volumes:
      - ./hrconvert2_data:/data:rw
    networks:
      - iahome-network

  # Service Pandoc pour conversion de documents
  pandoc:
    image: pandoc/latex:latest
    container_name: hrconvert2-pandoc
    restart: unless-stopped
    volumes:
      - ./hrconvert2_data:/data:rw
    networks:
      - iahome-network

  # Service Calibre pour conversion d'eBooks
  calibre:
    image: lscr.io/linuxserver/calibre:latest
    container_name: hrconvert2-calibre
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Paris
    volumes:
      - ./calibre_data:/config
      - ./hrconvert2_data:/converter:rw
    networks:
      - iahome-network

networks:
  iahome-network:
    external: true
