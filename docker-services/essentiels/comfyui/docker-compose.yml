# ⚠️ ATTENTION : Cette configuration Docker ne fonctionne plus
# Les images Docker ComfyUI ne sont plus disponibles
# 
# SOLUTION : Utilisez Stability Matrix pour installer et gérer ComfyUI
# Voir le fichier FIX-DEMARRAGE-COMPFYUI.md pour les instructions complètes
#
# Pour utiliser Docker, vous devez :
# 1. Construire votre propre image depuis le Dockerfile (si disponible)
# 2. Ou utiliser Stability Matrix (recommandé)

services:
  comfyui:
    # Image non disponible - utiliser Stability Matrix à la place
    # image: yanwk/comfyui:latest
    build:
      context: .
      dockerfile: Dockerfile
    container_name: comfyui
    restart: unless-stopped
    ports:
      - "0.0.0.0:8188:8188"
    volumes:
      - ./models:/app/models
      - ./output:/app/output
      - ./input:/app/input
      - ./custom_nodes:/app/custom_nodes
    environment:
      - CLI_ARGS=--listen 0.0.0.0 --port 8188
    networks:
      - iahome-network
    # SUPPRIMER les labels Traefik - plus d'accès direct
    # labels:
    #   - "traefik.enable=true"
    #   - "traefik.http.routers.comfyui.rule=Host(`comfyui.iahome.fr`)"
    #   - "traefik.http.routers.comfyui.entrypoints=websecure"
    #   - "traefik.http.routers.comfyui.tls=true"
    #   - "traefik.http.routers.comfyui.tls.certresolver=letsencrypt"
    #   - "traefik.http.services.comfyui.loadbalancer.server.port=8188"
    #   - "traefik.docker.network=iahome-network"

networks:
  iahome-network:
    external: true

